# https://learn.microsoft.com/en-us/azure/ai-services/agents/quickstart?pivots=rest-api
# az account get-access-token --resource https://ml.azure.com/ 

@token = eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkNOdjBPSTNSd3FsSEZFVm5hb01Bc2hDSDJYRSIsImtpZCI6IkNOdjBPSTNSd3FsSEZFVm5hb01Bc2hDSDJYRSJ9.eyJhdWQiOiJodHRwczovL21sLmF6dXJlLmNvbS8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zYWQwYjkwNS0zNGFiLTQxMTYtOTNkOS1jMWRjYzJkMzVhZjYvIiwiaWF0IjoxNzQ0NzMwMjQzLCJuYmYiOjE3NDQ3MzAyNDMsImV4cCI6MTc0NDczNTg4MCwiYWNyIjoiMSIsImFpbyI6IkFYUUFpLzhaQUFBQVJiNUxvZU9rN0NNWFYwd3ljTU9yYzJDQkVBejNOS0ZWZWl2alZOdzRWdnVzdTJpWVpRUjM2eGlKeWN3RkFoNEZLRGFUdjRvTFduaWEwNEs2R09ORUZVYWJseFEyQWJPKzV2cWxtaXNUR1JkNnBCeWVQeUR2d1FHTXhPMlZnTU5pMlNFSXRaTEx3aGJNNjROOHlnSkdIdz09IiwiYW1yIjpbInB3ZCIsInJzYSIsIm1mYSJdLCJhcHBpZCI6IjA0YjA3Nzk1LThkZGItNDYxYS1iYmVlLTAyZjllMWJmN2I0NiIsImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiYzZkNzgzNGMtYzUzYS00ZDU1LThjYmYtMDNiMGM3ZWU3YjJmIiwiZmFtaWx5X25hbWUiOiJNaW5lbGxhIiwiZ2l2ZW5fbmFtZSI6Ik1hdXJvIiwiZ3JvdXBzIjpbIjlkNTZmZjRlLTYyOTMtNDBjNS04NmZkLWVmMjg1YWU5ZjU2NCIsImMzZGE0MjkxLTlhMTgtNDQyOS1hNWY5LTk5YWIxYjA1ODc1MyJdLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiI5My41Ni4xMDQuMjQ5IiwibmFtZSI6Ik1hdXJvIE1pbmVsbGEiLCJvaWQiOiI2OGM0YmYxZS03YzQ5LTRmOTItYThmNS0wZDMzMTgzMWM1MWEiLCJwdWlkIjoiMTAwMzIwMDNBQUZDOThDOSIsInB3ZF91cmwiOiJodHRwczovL3BvcnRhbC5taWNyb3NvZnRvbmxpbmUuY29tL0NoYW5nZVBhc3N3b3JkLmFzcHgiLCJyaCI6IjEuQWIwQUJiblFPcXMwRmtHVDJjSGN3dE5hOWw5dnBoamYyeGRNbmRjV05IRXFuTDREQVVLOUFBLiIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInNpZCI6IjAwM2Y1YWQ5LTNmYzEtMzQyNy1lMjAzLWYzODZlYzI3ZWU5YiIsInN1YiI6IjJPM2h5YWhhU2hvS3FRbG0xZXRLQkh2ODRyamRSQ0NUSTdMUWRxZjNrdTQiLCJ0aWQiOiIzYWQwYjkwNS0zNGFiLTQxMTYtOTNkOS1jMWRjYzJkMzVhZjYiLCJ1bmlxdWVfbmFtZSI6Im1hdXJvLm1pbmVsbGFATW5nRW52TUNBUDg4MzY1Mi5vbm1pY3Jvc29mdC5jb20iLCJ1cG4iOiJtYXVyby5taW5lbGxhQE1uZ0Vudk1DQVA4ODM2NTIub25taWNyb3NvZnQuY29tIiwidXRpIjoicWFFaUdORXVXMDJlVHJvMHYwa3BBQSIsInZlciI6IjEuMCIsInhtc19pZHJlbCI6IjEgMjQifQ.Vl7GkuV39GmL_9lxRDw7DIR7MblL8C_38yXKurLcH8N4hAwmf2RhzMtdfyNaW7BIc71_kDESQhNr_zkRjSNoDEE1CDBKjPUKTUELXXO4dHsmS-I32Tl0JMRpOMMLYQTXBNTvmpn4-6I0tdBvRTFCaqTSlNn8jAsajVts7vR_AtA7Z__rIY6D2ohJQoTMkIFgOLDurY_UX7iRmB9uunMguGTbh1gC6J6TVD0PScrrhe5OzLm_ncwWociigw7dNUYOYSH6kLM55hBsR4WR_GcL1GaZ3Qrh4bdnJcRChFxJgHuUZub2mUI6wfJpkFsbJp6w_fj2BOwTuFOsCYutHGaDzg

@agents-service_endpoint = https://eastus.api.azureml.ms/agents/v1.0/subscriptions/eca2eddb-0f0c-4351-a634-52751499eeea/resourceGroups/mmai04-rg/providers/Microsoft.MachineLearningServices/workspaces/mmai-hub04-prj01-fvye


@thread_id = thread_QfQz8A5b1In1fIrKwwEAH216

@agent_id = asst_A0UWDQ9zsQ5QbIQJT7lMp2bF


# create thread id, given the project
POST {{agents-service_endpoint}}/threads?api-version=2024-12-01-preview
Authorization: Bearer {{token}}
Content-Type: application/json

{}

###

# add a message to the thread, given the thread id
POST {{agents-service_endpoint}}/threads/{{thread_id}}/messages?api-version=2024-12-01-preview
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "role": "user",
    "content": "Cosa posso vedere in TV stasera"
}


###
# run the thread, given the thread id and the agent id
POST {{agents-service_endpoint}}/threads/{{thread_id}}/runs?api-version=2024-12-01-preview
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "assistant_id": "{{agent_id}}"
}

###
# retrieve the run_id from the previous response

@run_id = run_9IJVEy7dDcndG0sPGPAYA8lV
###
# get the run, given the thread id and the run id
GET {{agents-service_endpoint}}/threads/{{thread_id}}/runs/{{run_id}}?api-version=2024-12-01-preview
Authorization: Bearer {{token}}
Content-Type: application/json