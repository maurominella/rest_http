# https://learn.microsoft.com/en-us/azure/ai-services/agents/quickstart?pivots=rest-api
# az login --use-device-code --tenant <your-tenant-id-or-domain>
# az config set extension.dynamic_install_allow_preview=true
# az account tenant list --output table
# for Azure Management tasks --> az account get-access-token --resource https://management.core.windows.net/
# for OpenAI tasks --> az account get-access-token --resource https://cognitiveservices.azure.com/
# for Azure Search tasks --> az account get-access-token --resource https://search.azure.com/

# OpenAI Endpoints:
# - OpenAI main:     {{azure_openai_main_endpoint}}, {{azure_openai_main_servicename}}, {{azure_openai_main_apikey}}
# - OpenAI fallback: {{azure_openai_fallback_endpoint}}, {{azure_openai_fallback_servicename}}, {{azure_openai_fallback_apikey}}
# - APIM:            {{apim_service_gatewayurl}}/{{apim_api_name}}/, {{apim_subscription_key_premium}}

@azure_openai_endpoint = {{azure_openai_main_endpoint}}
@azure_openai_servicename = {{azure_openai_main_servicename}}
@azure_openai_apikey = {{azure_openai_main_apikey}}

###
# Get the list of available models, regardless of being deployed or not
GET {{azure_openai_endpoint}}/openai/models?api-version={{azure_openai_api_version}}
Api-Key: {{azure_openai_apikey}}
Content-Type: application/json

###
# Gets the deployments associated with the Cognitive Services account: https://learn.microsoft.com/en-us/rest/api/aiservices/accountmanagement/deployments/list
# Requires Bearer Token authentication, and max 2025-04-01-preview API version
GET https://management.azure.com/subscriptions/{{subscription_id}}/resourceGroups/{{azure_openai_resourcegroup}}/providers/Microsoft.CognitiveServices/accounts/{{azure_openai_servicename}}/deployments?api-version={{apim_api_version}}
Authorization: Bearer {{bearertoken_for_azuremanagement}}